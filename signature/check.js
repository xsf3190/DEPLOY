import crypto from "crypto";

const algorithm = "SHA256";

const publicKey = `LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJDZ0tDQVFFQXZ0MW1IYXlSMmxmK0cxZXQ3aHMvV2tVTXNmb2VFN2QrQ04rZ3Rja3RUYWRzQ0NxNWw5eEsKR2JMeU16NW5kYjdvZXJQZ2krS3ZsYm9RWC81Y3NBNmlBakhxSUxhTEo4aFJmWlI2ckliRlg1ZjU0ejFNU2hjcgpoZ2JRNWN0ai81b0x6NGg0ZDJjTm1wM2lidHdMcitWM0lFejViaGdzSTh4dGF5OEVBdVprV2dzMzRMWm03RWd1CmVIU21RcGlLb1l3MmprVVpWN2c5SWVZTnBDVncySlFSbGpYRDFOdDRHSjdMTVhBMTAvbTBwZ3RTREw4ZnB0N1cKR2pkM282NVBCQUNsZ2w1RGRKRnExSDlCT2hGbFh0WUt0L3p2cFd1N1hoc3dhVXJGRFVrT0hxVDZDUmVUOUlScAo2KzZwS0ozRDg0WVpNQlRORnI3alRrVkVYYkJ5cHlyTGt3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K`;
const privateKey =   `LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBdnQxbUhheVIybGYrRzFldDdocy9Xa1VNc2ZvZUU3ZCtDTitndGNrdFRhZHNDQ3E1Cmw5eEtHYkx5TXo1bmRiN29lclBnaStLdmxib1FYLzVjc0E2aUFqSHFJTGFMSjhoUmZaUjZySWJGWDVmNTR6MU0KU2hjcmhnYlE1Y3RqLzVvTHo0aDRkMmNObXAzaWJ0d0xyK1YzSUV6NWJoZ3NJOHh0YXk4RUF1WmtXZ3MzNExabQo3RWd1ZUhTbVFwaUtvWXcyamtVWlY3ZzlJZVlOcENWdzJKUVJsalhEMU50NEdKN0xNWEExMC9tMHBndFNETDhmCnB0N1dHamQzbzY1UEJBQ2xnbDVEZEpGcTFIOUJPaEZsWHRZS3QvenZwV3U3WGhzd2FVckZEVWtPSHFUNkNSZVQKOUlScDYrNnBLSjNEODRZWk1CVE5GcjdqVGtWRVhiQnlweXJMa3dJREFRQUJBb0lCQUFnK0t0L1RNOFZZa1gvVgpkemNybnI1NDhac1V4ZUhDRzBPcUxNTDN1ajRsVElsdkZ1N1RzN0RpYjkvK0FrZlgyU3NiYmtkOFN4V2pTeVpxCkozbnZBb045RmwzQ3BIQ0daVEU2NHJBUUdLRmxRSVNBMXQrZG1vMUNQc1A5MXdhOTUyUUNGODhkb3owWjNuZm4KM0VBRXlwMUVLeGd4eG1PUlpqNy94bmpvUWFNN0pOWnpHR1hzTHY2dm10VGpCSHM0WnZIQk4xRHJwUFlwZHBIbwpOS3gzM3RHWkp4cGlLeHkyTjk4ajNjbERQSGhDa2NqTExJc0kxbGEwK09aV1I2V0VmK1gyUCtqZUhlTHFicGRoCmVGWU55QkRzQks5S1RQQ0hoRVlnNWY2Qi9NOVJwemswcVpGZUFPTXdzY25idE5kQmxRWm0rQWIvZWxpWTVMTzkKV1VzU1VnRUNnWUVBLzRVcXVCbnMrbUdib1BwUUFTVzJpTmU4eXNMcFpJSFByN0JLak1leWMvQmlOQWpmRXV4egpyWVBLWTBWUW1WTFZlYmxhc1JuSG5rMmJRZERFbTgrVkp2VHc0MWlsbFB5QjlWQkZhUzlLN3dteHBQSzFrbFZZCi8yRUN5L25uZ2pJdnBBWFlWam1qdkdUa2kxcXBFT04zUmNtQWF1QlB0N1AwNDAvSTdENXlBSk1DZ1lFQXZ6a20KcWx1aWkzbDVHU0w0eWMwb211cG54T2Z2RmpWUnlURDFWdjdWTXNrUzV4OHNsdlhXMDBSVUx5S0t6T3ZpVzFwawpDaUpiWWUzbHVHZGlIbTlaWGZMODNtelhIVnNGVkt4djErMi9FenhTTTVOYmV0Q3pDMGw2cEs0elk1WUIvclpZCmh1WjdpSHgrclRUSUM0WmpDY3E4cjFhV211RElNbE5Wa1dmaDZRRUNnWUVBb1F2em90bGtUV01iemRnMmVLS20KYTVWZC9vWGV5R1F3M0ZER2kvaUpkeDE1SjhhM29wdTVSUkdkaS9meUZ0RG9qN0hOZ1hYNEpNUlJLS2hHWXRYdwo4ZjdMbk44UWJkakFxRGNScUh3UVJKemRoRk1kTWIvdE9maVE1TEw3d1VtVVVWTUZ5VUxHK2tTMDcwZ1M2dndTCi9yOUQyeGpKNWNUY2dqQ1ZPS0ViQlZVQ2dZQkNUUXVGOTcyMUJFb2ptQWVRMkt4aWdqRzJpUUJSdit6NmlCb1kKcnNTM0ZoYVN3akZRcWk1eEUvam9XdDZyVElJd1VIZnRONXBkcXdHQ1hYNGN0VmpVQlVMOXo5a0tHWndRanJVOAp0ZmNSTVZJREJlMnErSitMbzA5OXQ5U2ppOGhuUzB3SWdmT0ZFRDFQeXNRdGtzdldBbEJIcndzSzZqTWZsOXRNClRpdDdBUUtCZ0dhSFQvTi9uTnpVNHJoZEV1ekQzOTMxNXJFTUZYd2ZwTDg0WTlub0ZFL0xYZ1ZCamhSbHRERDMKY3MyOVlHMHpIdHQyTWVYRXAvQ2ZPeEQ0SlNLZ2E2ZGZNNFJDeVIwZ3hBRFJEN1hLSzVEMG9GN1VWZmJLMVpBZApwNDR6VXRPUDZuSFZTRnB0N0hEMHhiNmZnVUpLaHFZVTBVWmUxZXlxc1psMW1iVXdkaHdRCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==`;

const email = "mark.russellbrown@gmail.com";
console.log(email);

let data = Buffer.from(email);

const pKey = crypto.createPrivateKey({
    key: Buffer.from(privateKey, "base64").toString(),
    format: "pem",
    type: "pkcs1"
});

const pubKey = crypto.createPublicKey({
    key: Buffer.from(publicKey, "base64").toString(),
    format: "pem"
});

let signature = crypto.sign(algorithm, data, pKey).toString("base64");

console.log(signature);

let isVerified = crypto.verify(algorithm, data, pubKey, Buffer.from(signature, "base64"));

console.log(`Signature verified: ${isVerified}`);